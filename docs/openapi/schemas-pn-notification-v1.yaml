components:
  schemas:

    IUN:
      description: Identificativo Univoco Notifica
      type: string

    NewNotificationRequest:
      description: I campi utilizzati per la creazione di una nuova Notifica.
      type: object
      required:
        - paNotificationId
        - subject
        - recipients
        - documents
        - physicalCommunicationType
      properties:
        paNotificationId:
          description: >-
            Numero di protocollo che la PA mittente assegna alla notifica stessa
          type: string
        subject:
          type: string
          description: titolo della notifica
        abrastract:
          type: string
          description: descrizione sintetica della notifica
        recipients:
          type: array
          description: Informazioni sui destinatari
          items:
            $ref: "#/components/schemas/NotificationRecipient"
        documents:
          type: array
          description: Documenti notificati
          items:
            $ref: "#/components/schemas/NotificationAttachment"
        
        cancelledIun:
          type: string
          description: IUN della notifica rettificata da questa notifica
        
        physicalCommunicationType:
          type: string
          description: Tipologia comunicazione fisica
          enum:
          - SIMPLE_REGISTERED_LETTER
          - REGISTERED_LETTER_890
    
    NotificationRecipient:
      description: Informazioni sui destinatari
      required:
      - denomination
      - recipientType
      - taxId
      type: object
      properties:
        recipientType:
          type: string
          description: 'Tipologia di destinatario: Persona Fisica (PF) o Persona Giuridica
            (PG)'
          enum:
          - PF
          - PG
        taxId:
          type: string
          description: Codice Fiscale del destinatario
        denomination:
          type: string
          description: Nome e cognome / ragione sociale
        digitalDomicile:
           $ref: "#/components/schemas/NotificationDigitalAddress"
        physicalAddress:
          $ref: "#/components/schemas/NotificationPhysicalAddress"
        payment:
          $ref: "#/components/schemas/NotificationPaymentInfo"

    NotificationAttachment:
      description: Modulo F24 per spese di notifica analogica
      type: object
      required:
        - digests
      properties:
        digests:
          "$ref": "#/components/schemas/NotificationAttachmentDigests"
        contentType:
          type: string
          description: tipo di contenuto dell'allegato
        title:
          type: string
          description: Titolo del documento allegato
        body:
          type: string
          description: corpo dell'allegato
        ref:
          $ref: "#/components/schemas/NotificationAttachmentBodyRef"
      

    NotificationAttachmentDigests:
      description: codice di controllo del F24 per spese di notifica analogica
      type: object
      required:
        - sha256
      properties:
        sha256:
          type: string
          description: Digest "sha256" della codifica binaria dell'allegato
    
    NotificationAttachmentBodyRef:
      description: Riferimento all'allegato precaricato
      required:
        - key
        - versionToken
      type: object
      properties:
        key:
          type: string
          description: Chiave in cui è stato salvato l'allegato
        versionToken:
          type: string
          description: Token per recuperare l'esatta istanza dell'allegato
    
    NotificationDigitalAddress:
      description: Indirizzo di invio della notifica
      required:
      - address
      - type
      type: object
      properties:
        type:
          type: string
          description: tipo di indirizzo PEC, REM, SERCQ, ...
          enum:
          - PEC
        address:
          type: string
          description: account@domain
      

    NotificationPhysicalAddress:
      type: object
      properties:
        at:
          type: string
          description: Campo "presso" dell'indirizzo
        address:
          type: string
          description: Indirizzo del domicilio fisico
        addressDetails:
          type: string
          description: Seconda riga dell'indirizzo fisico
        zip:
          type: string
          description: Codice di avviamento postale
        municipality:
          type: string
          description: Comune in cui l'indirizzo si trova
        province:
          type: string
          description: Provincia in cui si trova l'indirizzo
        foreignState:
          type: string
          description: Denominazione paese estero
      description: Indirizzo fisico scoperto durante fase di consegna
    

    NotificationPaymentInfo:
      description: Informazioni per effttuare il pagamento
      type: object
      required:
        - notificationFeePolicy
        - noticeNumber
        - creditorTaxId
        - pagoPaForm
      properties:
        notificationFeePolicy:
          type: string
          description: Politica di addebitamento dei costi di notifica
          enum:
          - FLAT_RATE
          - DELIVERY_MODE
        noticeNumber:
          type: string
          description: Numero Avviso di pagamento del sistema pagoPA, usato per pagamento online
        creditorTaxId:
          type: string
          description: Codice fiscale dell'ente a cui fa riferimento il "numero avviso".
        pagoPaForm:
          $ref: "#/components/schemas/NotificationAttachment"
        f24:
          $ref: "#/components/schemas/SetOfF24"

    SetOfF24:
      type: object
      title: Elenco moduli di pagamento F24
      description: >-
        ## Moduli di pagamento F24 da compilare in riferimento al notificationFeePolicy
        - _flatRate_: 
        - _digital_: 
        - _digitalWithRs_: 
        - _analogRaccSingle_: 
        - _analogRaccDouble_: 
        - _analogRiSingle_: 
        - _analogRiDouble_: 
      properties:
        flatRate:
          $ref: "#/components/schemas/NotificationAttachment"
        digital:
          $ref: "#/components/schemas/NotificationAttachment"
        digitalWithRs:
          $ref: "#/components/schemas/NotificationAttachment"
        analogRaccSingle:
          $ref: "#/components/schemas/NotificationAttachment"
        analogRaccDouble:
          $ref: "#/components/schemas/NotificationAttachment"
        analogRiSingle:
          $ref: "#/components/schemas/NotificationAttachment"
        analogRiDouble:
          $ref: "#/components/schemas/NotificationAttachment"
    
    Notification_Sent:
      description: Le notifiche di Piattaforma Notifiche
      required:
      - documents
      - paNotificationId
      - physicalCommunicationType
      - recipients
      - subject
      type: object
      properties:
        iun:
          type: string
          description: L'Identificativo Univoco Notifica assegnato da PN
        paNotificationId:
          type: string
          description: Numero di protocollo che la PA mittente assegna alla notifica
            stessa
        subject:
          type: string
          description: titolo della notifica
        sentAt:
          type: string
          description: Momento di ricezione della notifica da parte di PN
          format: date-time
        cancelledIun:
          type: string
          description: IUN della notifica rettificata da questa notifica
        cancelledByIun:
          type: string
          description: IUN della notifica che ha rettificato questa notifica
        recipients:
          type: array
          description: Informazioni sui destinatari
          items:
            "$ref": "#/components/schemas/NotificationRecipient"
        documents:
          type: array
          description: Documenti notificati e lettere di accompagnamento
          items:
            "$ref": "#/components/schemas/NotificationAttachment"
        payment:
          "$ref": "#/components/schemas/NotificationPaymentInfo"
        #notificationStatus:
        #  type: string
        #  description: stato di avanzamento del processo di notifica
        #  enum:
        #  - IN_VALIDATION
        #  - ACCEPTED
        #  - DELIVERING
        #  - DELIVERED
        #  - VIEWED
        #  - EFFECTIVE_DATE
        #  - PAID
        #  - UNREACHABLE
        #  - REFUSED
        #notificationStatusHistory:
        #  type: array
        #  description: elenco degli avanzamenti effettuati dal processo di notifica
        #  items:
        #    $ref: "#/components/schemas/NotificationStatusHistoryElement"
        #timeline:
        #  type: array
        #  description: elenco dettagliato di tutto ciò che è accaduto durrante il
        #    processo di notifica
        #  items:
        #    $ref: "#/components/schemas/TimelineElement"
        physicalCommunicationType:
          type: string
          description: Tipologia comunicazione fisica
          enum:
          - SIMPLE_REGISTERED_LETTER
          - REGISTERED_LETTER_890

    

      
      
      